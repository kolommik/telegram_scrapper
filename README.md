# Telegram Scrapper

Telegram Scrapper - это приложение для сбора сообщений из Telegram каналов и их хранения в базе данных PostgreSQL. Приложение сохраняет сообщения, метаданные каналов, вложения и ответы на сообщения.

## Начало работы

Для запуска приложения необходимо иметь установленные Docker и Docker Compose.

### Установка

1. Клонируйте репозиторий:

```bash
git clone <URL репозитория>
```

2. Перейдите в каталог проекта:

```bash
cd <каталог проекта>
```

3. Создайте файл `.env` в корне проекта и заполните необходимые переменные окружения:

```plaintext
TELEGRAM_API_ID=<Ваш API ID>
TELEGRAM_API_HASH=<Ваш API Hash>
POSTGRES_DB=<Название базы данных>
POSTGRES_USER=<Имя пользователя базы данных>
POSTGRES_PASSWORD=<Пароль пользователя базы данных>
DB_HOST=db
DB_PORT=5432
DB_DATA_PATH=./data/db
IMAGES_PATH=./data/images
ATTACHMENTS_PATH=./data/attachments
TELEGRAM_SESSION_PATH=./session
APP_LOGS_PATH=./logs
```

3.1. Для получения `TELEGRAM_API_ID` и `TELEGRAM_API_HASH` необходимо создать приложение на платформе Telegram. Перейдите на [my.telegram.org](https://my.telegram.org), войдите в систему и следуйте инструкциям для создания нового приложения.

4. Запустите контейнеры:

```bash
docker-compose up -d
```

### Структура каталогов

В корне проекта находятся следующие директории и файлы:

- `app/` - исходный код приложения.
- `docs/` - документация проекта, сгенерированная с помощью Sphinx.
- `sql/` - SQL скрипты для инициализации базы данных.
- `docker-compose.yml` и `docker-compose_db_only.yml` - конфигурационные файлы для Docker Compose.
- `Dockerfile` - Dockerfile для сборки образа приложения.
- `.env` - файл с переменными окружения (необходимо создать самостоятельно).

## Использование

После запуска контейнеров приложение начнет сбор сообщений из Telegram каналов и сохранение их в базу данных PostgreSQL.

### Структура базы данных

База данных содержит следующие таблицы:

- `DialogTypes` - типы диалогов (каналы, чаты, пользователи).
- `Dialogs` - диалоги, включая метаданные каналов.
- `Messages` - сообщения из диалогов.
- `AttachmentTypes` - типы вложений.
- `Attachments` - вложения к сообщениям.
- `Replies` - ответы на сообщения.
